CC=clang

CFLAGS=--target=wasm32 -m32 -g -O0 -Wall -nostdlib -ffreestanding -nostdinc -I../musl-1.2.2/built_inc/include/
LIBS=-L../musl-1.2.2/lib -lc

SOURCES = main.c
OBJS = $(addprefix build/,$(SOURCES:.c=.o)) 

main: main.c
	$(CC) $(CFLAGS) -Wl,--no-entry -Wl,--export-all -Wl,--import-memory -Wl,--allow-undefined-file=wasm.syms $(LIBS) $< -o main.wasm

run:  main
	python3 -m http.server --bind 127.0.0.1 8080

clean:
	rm -rf main.wasm